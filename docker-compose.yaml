services:
  geo-deep-learning:
    build:
      dockerfile: Dockerfile
#    env_file:
#      - .env
#    tty: true
#    stdin_open: true
    user: '9005'
    shm_size: '32gb'
    container_name: geo-deep-learning
    volumes:
      - "/mnt/data_disk/projet_RCM_scanfire:/mnt/data_disk/projet_RCM_scanfire:rw"
      - "/home/xmalet/projects/geo-deep-learning/data:/app/data:rw"
      - "/home/xmalet/projects/geo-deep-learning/configs/rcm_change_detection.yaml:/app/configs/rcm_change_detection.yaml"
#    entrypoint: ["python",  "geo_deep_learning/train.py","fit", "--config", "configs/rcm_change_detection.yaml"]
    deploy:
      resources:
#        limits:
#          cpus: 0.5
#          memory: 50gb
        reservations:
          devices:
          - driver: nvidia
            count: all
            capabilities: [gpu]
